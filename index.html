<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TicTacToe AI-Agentic Dashboard</title>
  <style>
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;margin:0;padding:2rem;background:#f5f7fa;color:#1a202c;}
    .container{max-width:1200px;margin:0 auto;}
    h1{margin:0 0 0.5rem 0;font-size:2rem;color:#2d3748;}
    .subtitle{color:#718096;margin-bottom:2rem;font-size:1rem;}
    a{color:#3182ce;text-decoration:none;}
    a:hover{text-decoration:underline;}
    .card{background:white;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);}
    .card h2{margin:0 0 1rem 0;font-size:1.25rem;color:#2d3748;border-bottom:2px solid #e2e8f0;padding-bottom:0.5rem;}
    .metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem;margin-bottom:1.5rem;}
    .metric{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:1.25rem;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,0.1);cursor:pointer;transition:transform 0.2s;}
    .metric:hover{transform:translateY(-4px);box-shadow:0 6px 12px rgba(0,0,0,0.15);}
    .metric.secondary{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);}
    .metric.deprecated{background:#cbd5e0;color:#4a5568;opacity:0.7;}
    .metric-label{font-size:0.875rem;opacity:0.9;margin-bottom:0.25rem;font-weight:500;}
    .metric-value{font-size:2rem;font-weight:bold;margin-bottom:0.25rem;}
    .metric-target{font-size:0.75rem;opacity:0.8;}
    .metric-status{display:inline-block;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.75rem;margin-top:0.5rem;background:rgba(255,255,255,0.2);}
    .links{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:0.75rem;}
    .link-card{background:#f7fafc;padding:1rem;border-radius:6px;border-left:4px solid #3182ce;transition:all 0.2s;}
    .link-card:hover{background:#edf2f7;transform:translateX(4px);}
    .link-card a{display:block;font-weight:500;}
    .badge{display:inline-block;padding:0.25rem 0.75rem;border-radius:12px;font-size:0.75rem;font-weight:600;margin-left:0.5rem;}
    .badge.primary{background:#c3dafe;color:#2b6cb0;}
    .badge.new{background:#c6f6d5;color:#22543d;}
    .info{background:#ebf8ff;border-left:4px solid#3182ce;padding:1rem;border-radius:4px;font-size:0.875rem;color:#2c5282;}
    .timestamp{color:#a0aec0;font-size:0.875rem;margin-top:1rem;}
    .philosophy{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:2rem;border-radius:8px;margin-bottom:1.5rem;}
    .philosophy h2{margin:0 0 1rem 0;font-size:1.5rem;}
    .philosophy p{margin-bottom:0.75rem;line-height:1.8;}
    .comparison{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-top:1rem;}
    .comparison-col h3{margin:0 0 0.5rem 0;font-size:1.1rem;opacity:0.9;}
    .comparison-col ul{margin:0;padding-left:1.5rem;}
    .comparison-col li{margin-bottom:0.5rem;}
    .learn-more{display:inline-block;margin-top:1rem;padding:0.5rem 1rem;background:rgba(255,255,255,0.2);border-radius:6px;text-decoration:none;color:white;font-weight:500;transition:all 0.2s;}
    .learn-more:hover{background:rgba(255,255,255,0.3);text-decoration:none;}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:1000;align-items:center;justify-content:center;padding:2rem;}
    .modal.active{display:flex;}
    .modal-content{background:white;border-radius:12px;max-width:700px;max-height:90vh;overflow-y:auto;padding:2rem;position:relative;}
    .modal-close{position:absolute;top:1rem;right:1rem;font-size:1.5rem;cursor:pointer;background:none;border:none;color:#718096;}
    .modal-close:hover{color:#2d3748;}
    .modal-title{color:#667eea;font-size:1.8rem;margin-bottom:1rem;}
    .modal-section{margin-bottom:1.5rem;}
    .modal-section h4{color:#2d3748;margin-bottom:0.5rem;}
    .modal-section code{background:#f7fafc;padding:0.25rem 0.5rem;border-radius:4px;font-size:0.9rem;}
    .modal-section pre{background:#f7fafc;padding:1rem;border-radius:6px;overflow-x:auto;}
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ TicTacToe AI-Agentic Dashboard</h1>
    <div class="subtitle">Metrics reimagined for AI-driven development</div>
    
    <details class="philosophy" style="cursor:pointer;" open>
      <summary style="font-size:1.5rem;font-weight:600;list-style:none;cursor:pointer;">
        ü§ñ What is AI-Agentic Development? (Click to collapse)
      </summary>
      <div style="margin-top:1rem;">
        <p><strong>Core Principle:</strong> In AI-agentic development, <em>code is a specification artifact, not a hand-crafted asset</em>. AI agents generate and regenerate code from behavioral specifications.</p>
        
        <div class="comparison">
          <div class="comparison-col">
            <h3>‚ùå Traditional Metrics</h3>
            <ul>
              <li><strong>Line Coverage %</strong> - Measures test execution</li>
              <li><strong>Cyclomatic Complexity</strong> - Penalizes clarity</li>
              <li><strong>CRAP Score</strong> - Optimizes for brevity</li>
              <li><strong>DRY Enforcement</strong> - Forces abstraction</li>
            </ul>
          </div>
          <div class="comparison-col">
            <h3>‚úÖ AI-Agentic Metrics</h3>
            <ul>
              <li><strong>Specification Coverage</strong> - Can AI rebuild from specs?</li>
              <li><strong>Mutation Score</strong> - Quality of assertions</li>
              <li><strong>Regeneration Safety</strong> - Spec completeness</li>
              <li><strong>Context Efficiency</strong> - AI comprehension cost</li>
            </ul>
          </div>
        </div>
        
        <p style="margin-top:1rem;"><strong>Why this matters:</strong> Traditional metrics optimize for human-crafted code. They create false positives (100% coverage with weak tests) and false negatives (clear code flagged as "complex"). AI-agentic metrics measure what actually matters: Can the code be reliably regenerated from specifications?</p>
        
        <a href="metrics-framework/index.html" class="learn-more">üìñ Read Full Metrics Framework ‚Üí</a>
      </div>
    </details>
    
    <div class="card">
      <h2>üåü Primary AI-Agentic Metrics <span class="badge new">NEW</span></h2>
      <div class="metrics-grid">
        <div class="metric" id="spec-coverage-card">
          <div class="metric-label">üìã Specification Coverage</div>
          <div class="metric-value" id="spec-coverage-value">--</div>
          <div class="metric-target">Target: 25%+ ratio (1:4 spec:code)</div>
          <div class="metric-status" id="spec-coverage-status">Loading...</div>
        </div>
        <div class="metric" id="mutation-card">
          <div class="metric-label">üß¨ Mutation Score</div>
          <div class="metric-value">60%+</div>
          <div class="metric-target">Run: <code>dotnet stryker</code></div>
          <div class="metric-status">Quality gate: 60%</div>
        </div>
        <div class="metric" id="regen-safety-card">
          <div class="metric-label">‚ôªÔ∏è Regeneration Safety</div>
          <div class="metric-value">80%+</div>
          <div class="metric-target">Code regenerable from specs</div>
          <div class="metric-status">See workflow results</div>
        </div>
        <div class="metric" id="performance-card">
          <div class="metric-label">‚ö° Performance</div>
          <div class="metric-value" id="perf-value">~26Œºs</div>
          <div class="metric-target">AI move calculation</div>
          <div class="metric-status" id="perf-status">BenchmarkDotNet</div>
        </div>
      </div>
      <div class="info">
        <strong>Philosophy:</strong> In AI-agentic development, specifications are the primary artifact. Code is generated and regenerated from specs. Quality = Specification completeness + Behavioral correctness.
      </div>
    </div>

    <div class="card">
      <h2>üìä Secondary Metrics <span class="badge primary">Behavioral Focus</span></h2>
      <div class="metrics-grid">
        <div class="metric secondary" id="line-coverage-card">
          <div class="metric-label">üìà Line Coverage</div>
          <div class="metric-value" id="line-coverage-value">--</div>
          <div class="metric-target">Relaxed threshold: 60%</div>
          <div class="metric-status" id="line-coverage-status">Loading...</div>
        </div>
        <div class="metric secondary" id="branch-coverage-card">
          <div class="metric-label">üîÄ Branch Coverage</div>
          <div class="metric-value" id="branch-coverage-value">--</div>
          <div class="metric-target">Behavioral completeness > %</div>
          <div class="metric-status" id="branch-coverage-status">Loading...</div>
        </div>
      </div>
      <div class="info">
        <strong>Note:</strong> Traditional coverage is secondary to specification coverage. It measures test execution, not behavioral completeness.
      </div>
    </div>

    <div class="card">
      <h2>üìé Documentation & Reports</h2>
      <div class="links">
        <div class="link-card">
          <a href="coverage/index.htm">üìä Coverage Report (HTML)</a>
          <small style="color:#718096;">Detailed structural coverage analysis</small>
        </div>
        <div class="link-card">
          <a href="livingdoc/index.html">üìñ Living Documentation</a>
          <small style="color:#718096;">SpecFlow BDD scenarios</small>
        </div>
        <div class="link-card">
          <a href="benchmarks.html">‚ö° Performance Benchmarks</a>
          <small style="color:#718096;">Historical performance tracking</small>
        </div>
        <div class="link-card">
          <a href="metrics-framework/index.html">üéØ Metrics Framework</a>
          <small style="color:#718096;">Complete metrics definition</small>
        </div>
      </div>
    </div>

    <details style="margin-top:1rem;">
      <summary style="cursor:pointer;padding:0.5rem;background:#f7fafc;border-radius:4px;font-weight:500;">
        ‚ö†Ô∏è Deprecated Metrics (Click to expand)
      </summary>
      <div class="card" style="margin-top:0.5rem;opacity:0.6;">
        <div class="metrics-grid">
          <div class="metric deprecated">
            <div class="metric-label">Cyclomatic Complexity</div>
            <div class="metric-value" style="font-size:1.25rem;">Deprecated</div>
            <div class="metric-target">AI generates optimal complexity</div>
          </div>
          <div class="metric deprecated">
            <div class="metric-label">CRAP Score</div>
            <div class="metric-value" style="font-size:1.25rem;">Hidden</div>
            <div class="metric-target">See coverage report internals</div>
          </div>
          <div class="metric deprecated">
            <div class="metric-label">DRY Enforcement</div>
            <div class="metric-value" style="font-size:1.25rem;">Relaxed</div>
            <div class="metric-target">Context > Abstraction</div>
          </div>
        </div>
        <div class="info" style="background:#fff5f5;border-color:#fc8181;color:#742a2a;">
          <strong>Why deprecated?</strong> These metrics optimize for human-crafted code. In AI-agentic development, they optimize for the wrong outcomes and create unnecessary constraints.
        </div>
      </div>
    </details>

    <div class="timestamp" id="timestamp">Loading...</div>
  </div>

  <!-- Modal for metric details -->
  <div id="metricModal" class="modal" onclick="if(event.target===this) this.classList.remove('active')">
    <div class="modal-content">
      <button class="modal-close" onclick="document.getElementById('metricModal').classList.remove('active')">‚úï</button>
      <div id="modalBody"></div>
    </div>
  </div>

  <script>
    const metricDetails = {
      'spec-coverage': {
        title: 'üìã Specification Coverage',
        description: 'Measures the ratio of specification lines (BDD scenarios) to production code lines.',
        why: 'In AI-agentic development, specifications are the source of truth. High specification coverage means AI can regenerate code reliably from behavioral definitions.',
        target: '25%+ ratio (1 line of spec for every 4 lines of code)',
        howToImprove: ['Write Given/When/Then scenarios for all user stories', 'Cover edge cases in feature files', 'Use Scenario Outlines for data variations', 'Document business rules as BDD scenarios'],
        tools: ['SpecFlow', 'Gherkin', 'Living Documentation generator'],
        example: 'If you have 100 lines of code, aim for 25+ lines of feature specifications.'
      },
      'mutation': {
        title: 'üß¨ Mutation Score',
        description: 'Measures test quality by introducing bugs and checking if tests catch them.',
        why: 'Traditional coverage can hit 100% but still have weak assertions. Mutation testing reveals if your tests actually verify behavior or just execute code.',
        target: '60%+ mutants killed',
        howToImprove: ['Write specific assertions (not just Assert.NotNull)', 'Test boundary conditions', 'Verify exact expected values', 'Check all return paths'],
        tools: ['Stryker.NET', 'dotnet-stryker'],
        example: 'Run: dotnet tool install -g dotnet-stryker && dotnet stryker'
      },
      'regen-safety': {
        title: '‚ôªÔ∏è Regeneration Safety',
        description: 'Tests if code can be deleted and regenerated from specifications without breaking tests.',
        why: 'The ultimate test of specification completeness. If AI can rebuild your code from specs and all tests pass, your specs are truly the source of truth.',
        target: '80%+ of modules regenerable',
        howToImprove: ['Write comprehensive BDD scenarios', 'Document interfaces and contracts', 'Include property-based tests for invariants', 'Keep modules focused (single responsibility)'],
        tools: ['GitHub Copilot', 'AI code generation', 'Automated regeneration tests'],
        example: 'Delete Board.cs ‚Üí AI reads GameBoard.feature ‚Üí Regenerates code ‚Üí Tests pass!'
      },
      'performance': {
        title: '‚ö° Performance Benchmarks',
        description: 'Tracks performance of critical code paths over time.',
        why: 'AI-generated code can inadvertently introduce performance regressions. Continuous benchmarking ensures performance stays stable.',
        target: '<10% variance from baseline',
        howToImprove: ['Benchmark critical paths', 'Set performance budgets', 'Use BenchmarkDotNet', 'Track allocations'],
        tools: ['BenchmarkDotNet', 'Performance testing'],
        example: 'AI move calculation: ~26Œºs (tracked over time)'
      }
    };

    function showMetricDetail(metricKey) {
      const detail = metricDetails[metricKey];
      if (!detail) return;
      
      let html = '<h2 class="modal-title">' + detail.title + '</h2>';
      html += '<div class="modal-section"><h4>What it measures:</h4><p>' + detail.description + '</p></div>';
      html += '<div class="modal-section"><h4>Why it matters:</h4><p>' + detail.why + '</p></div>';
      html += '<div class="modal-section"><h4>üéØ Target:</h4><p><strong>' + detail.target + '</strong></p></div>';
      html += '<div class="modal-section"><h4>üìà How to improve:</h4><ul>';
      detail.howToImprove.forEach(item => { html += '<li>' + item + '</li>'; });
      html += '</ul></div>';
      html += '<div class="modal-section"><h4>üõ†Ô∏è Tools:</h4><p>';
      detail.tools.forEach((t, i) => { 
        if (i > 0) html += ', ';
        html += '<code>' + t + '</code>'; 
      });
      html += '</p></div>';
      html += '<div class="modal-section"><h4>üí° Example:</h4><p>' + detail.example + '</p></div>';
      
      document.getElementById('modalBody').innerHTML = html;
      document.getElementById('metricModal').classList.add('active');
    }

    // Add click handlers to metrics
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('spec-coverage-card')?.addEventListener('click', () => showMetricDetail('spec-coverage'));
      document.getElementById('mutation-card')?.addEventListener('click', () => showMetricDetail('mutation'));
      document.getElementById('regen-safety-card')?.addEventListener('click', () => showMetricDetail('regen-safety'));
      document.getElementById('performance-card')?.addEventListener('click', () => showMetricDetail('performance'));
    });

    // Load coverage summary
    fetch('coverage-summary.json')
      .then(r => r.json())
      .then(d => {
        const linePct = (d.lineRate * 100).toFixed(1);
        const branchPct = (d.branchRate * 100).toFixed(1);
        
        document.getElementById('line-coverage-value').textContent = linePct + '%';
        document.getElementById('branch-coverage-value').textContent = branchPct + '%';
        
        const lineStatus = parseFloat(linePct) >= 60 ? '‚úÖ Above threshold' : '‚ö†Ô∏è Below 60%';
        const branchStatus = parseFloat(branchPct) >= 50 ? '‚úÖ Good' : 'üìä Monitor';
        
        document.getElementById('line-coverage-status').textContent = lineStatus;
        document.getElementById('branch-coverage-status').textContent = branchStatus;
        
        document.getElementById('timestamp').textContent = 'Last updated: ' + d.generatedUtc;
      })
      .catch(e => {
        document.getElementById('line-coverage-value').textContent = 'N/A';
        document.getElementById('branch-coverage-value').textContent = 'N/A';
        document.getElementById('line-coverage-status').textContent = 'Data unavailable';
        document.getElementById('branch-coverage-status').textContent = 'Data unavailable';
      });

    // Load specification coverage
    fetch('spec-coverage.json')
      .then(r => r.json())
      .then(d => {
        if (d.specificationCoverage) {
          const score = d.specificationCoverage.score || 0;
          const ratio = d.specificationCoverage.ratio || 0;
          
          document.getElementById('spec-coverage-value').textContent = score.toFixed(0) + '%';
          
          const status = score >= 100 ? 'üéØ Excellent!' : 
                         score >= 75 ? '‚úÖ Good' :
                         score >= 50 ? 'üìà Improving' : '‚ö†Ô∏è Needs work';
          document.getElementById('spec-coverage-status').textContent = 
            status + ' (Ratio: ' + (ratio * 100).toFixed(1) + '%)';
        }
      })
      .catch(e => {
        document.getElementById('spec-coverage-value').textContent = 'Run pending';
        document.getElementById('spec-coverage-status').textContent = 'First run in progress';
      });
  </script>
</body>
</html>
